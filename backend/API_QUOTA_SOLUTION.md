# Gemini API 配額限制說明與解決方案

## 問題現象
錯誤訊息：**429 Quota exceeded**
- 免費方案限制：每分鐘 5 次請求
- 每天限制：1500 次請求
- 模型：gemini-2.5-flash

## 根本原因
原始實作會為每個投影片調用一次 API：
- 1 次開場白
- 13 次逐頁講稿
- 12 次轉場語
- **總計：26 次 API 調用** ❌

這遠超過免費方案的每分鐘 5 次限制！

## ✅ 解決方案

### 已實施：優化為單次 API 調用
修改 `script_generator.py`，將所有請求合併為**一次 API 調用**：
- 整合所有投影片內容到單一 Prompt
- 一次性生成完整文稿
- 後端解析並分段顯示
- **總計：1 次 API 調用** ✅

### 優勢
- 🚀 大幅減少 API 調用次數（26次 → 1次）
- 💰 節省配額（可處理更多 PPT）
- ⚡ 速度更快（單次調用比多次快）
- 🎯 內容連貫性更好

## 配額管理建議

### 免費方案限制（Free Tier）
- ⏱️ **每分鐘**：5 次請求
- 📅 **每天**：1,500 次請求
- 📄 **每次**：最多 32,000 tokens

### 如需更高配額
1. **升級到付費方案**
   - 訪問：https://ai.google.dev/pricing
   - Pay as you go 方案無限制

2. **申請增加配額**
   - Google Cloud Console
   - 選擇專案
   - 申請配額調整

3. **使用不同模型**
   - `gemini-2.0-flash` - 配額可能不同
   - `gemini-2.5-pro` - 更強大但配額更嚴格

## 監控使用量
訪問 Google AI Studio：
- https://aistudio.google.com/app/apikey
- 查看當前配額使用情況
- 設置警報

## 後端已自動重載
修改已生效，無需手動重啟後端。

---

**現在可以正常使用了！** 每次生成只會調用 1 次 API。
